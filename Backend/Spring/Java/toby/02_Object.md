# 1장. 오브젝트와 의존관계
## 1.1. 쓰래기 DAO 구현해보기
- 객체지향 안티패턴의 결정체라 할 수 있는 TrashUserDao를 구현하고 개선해보자
- 중요한 건 여기서 던질 질문들이다.
    - 기능 잘 동작하는 이 코드가 도대체 무슨 문제가 있을까?
    - 잘 동작하는 코드를 굳이 왜 고쳐야 할까?
    - 개선했을 때 있는 장점은 무엇인가?
    - 이 장점은 지금 당장 효과가 있나? 이후에도 좋은가?
    - 객체지향 설계 원칙은 또 이거랑 뭔 상관인가?
    - 스프링을 사용하는 관점에서 이 개선안은 어떤 의미가 있는가?
- 그냥 따라 치는 게 아니라 이런 의문에 관심을 기울이고 개선하는 것이 가장 중요하다.

### 1.2. 쓰래기 DAO를 개선하자
- 소프트웨어의 변화
    - 모든 소프트웨어는 변화한다.
    - 끝이란 없다. 폐기하는 날이 끝나는 날이다.
    - 해야 하는 이유
        - 배경에서 나왔듯 소프트웨어는 늘 변하기 때문에 변화에 대비하는 코드를 만드는 게 중요하다.
        - 그래야 효율적으로 개발할 수 있다.
        
- 객체지향 설계의 가치
    - 일반적으로 실세계를 최대한 가깝게 모델링할 수 있는 걸 객체지향의 가치로 여김
    - 실제로는 객체지향 기술이 만들어내는 `가상의 추상세계` 자체에 있다.
    - 객체지향의 `추상세계`는 자유롭고 편리하게 변경, 발전, 확장 시키는 데 큰 도움을 준다.
        - ArrayList 같은 건 실제 세계에 존재하지 않는다.
        - 하지만 객체지향에서는 존재할 수 있는 추상 개념이며, 개발자들이 자바 컬렉션을 다루는 데 아주 큰 도움을 준다. 

- 변화에 대응하는 우리의 자세
    - 변화의 폭 자체를 줄여주면 된다.
        - 변화가 발생했을 때 우리 코드가 영향 받는 부분을 최소화시키면 된다
    - 분리와 확장을 고려한 설계가 필요하다!

- 분리를 고려한 설계
    - 모든 변경과 발전은 한 번에 한가지 관심사항에 집중해서 일어난다.
        - 여러군데 산발적으로 일어나는 건 요구사항 정리 차원에서 걸러줘야 한다.
    - 그러므로 변경이 발생했을 때 우리의 코드도 그 변경 관심사항에 맞게 한군데서 변화가 일어나면 대응하기 쉽다.
    - 즉, 관심사가 비슷한 오브젝트끼리 모아서 관리하면 유연한 설계를 할 수 있다.

- 쓰래기 DAO의 관심사항
    - 현재 최소 세가지의 관심사항이 있다.
        - 어떻게 DB 연결을 할 것인가
        - 어떻게 SQL을 만들고 실행할 것인가.
        - 어떻게 다 쓴 공유 자원을 반환할 것인가.
    - 이 외 더 세부적인 관심사가 있지만 일단 패스
    
- 중복된 코드를 제거하자
    - 메서드 추출을 통해 `DB 연결`이라는 관심사를 분리할 수 있다.
    - 이렇게 분리를 통해 앞으로 추가될 기능들이 DB 연결에는 신경쓰지 않아도 된다.
    - 중복 코드는 아주 강력한 리팩토링 대상이다. 냄새를 잘 맡자.
    
- 리팩토링
    - 현재 기능을 변경하지 않고 내부 구조를 개선하는 작업, 기술
    - 자동화 된 테스트가 필수다. 이거 없으면 코드를 변경하고 이게 잘 동작하는지 확신을 가질 방법이 없다.
    - 이런 관점으로 볼 때 현재는 테스트 코드도 쓰래기다.
    - 매번 테스트 실행 전에 DB를 확인하고 테스트 데이터와 중복되는 데이터가 있으면 삭제하고 다시 실행하는 수동적인 방법이 필요하다. 
